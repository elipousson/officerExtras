<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Wrappers for officer::body_add_par() and officer::body_add_xml() that use
the cursor_docx() helper functions to allow input of filename and path and
use of multiple options for cursor placement. add_text_to_body() passes
value to glue::glue() to add support for glue string interpolation.
add_gt_to_body() converts gt tables to OOXML with gt::as_word(). If pos = NULL, add_to_body() calls officer::body_add() instead of
officer::body_add_par()."><title>Add an xml string, text paragraph, or gt object at a specified position in a
Word document — add_to_body • officerExtras</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add an xml string, text paragraph, or gt object at a specified position in a
Word document — add_to_body"><meta property="og:description" content="Wrappers for officer::body_add_par() and officer::body_add_xml() that use
the cursor_docx() helper functions to allow input of filename and path and
use of multiple options for cursor placement. add_text_to_body() passes
value to glue::glue() to add support for glue string interpolation.
add_gt_to_body() converts gt tables to OOXML with gt::as_word(). If pos = NULL, add_to_body() calls officer::body_add() instead of
officer::body_add_par()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">officerExtras</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/elipousson/officerExtras/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Add an xml string, text paragraph, or gt object at a specified position in a
Word document</h1>
      <small class="dont-index">Source: <a href="https://github.com/elipousson/officerExtras/blob/HEAD/R/add_to_body.R" class="external-link"><code>R/add_to_body.R</code></a></small>
      <div class="d-none name"><code>add_to_body.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Wrappers for <code><a href="https://davidgohel.github.io/officer/reference/body_add_par.html" class="external-link">officer::body_add_par()</a></code> and <code><a href="https://davidgohel.github.io/officer/reference/body_add_xml.html" class="external-link">officer::body_add_xml()</a></code> that use
the <code><a href="cursor_docx.html">cursor_docx()</a></code> helper functions to allow input of filename and path and
use of multiple options for cursor placement. <code>add_text_to_body()</code> passes
value to <code><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue::glue()</a></code> to add support for glue string interpolation.
<code>add_gt_to_body()</code> converts gt tables to OOXML with <code><a href="https://gt.rstudio.com/reference/as_word.html" class="external-link">gt::as_word()</a></code>. If <code>pos = NULL</code>, <code>add_to_body()</code> calls <code><a href="https://davidgohel.github.io/officer/reference/body_add.html" class="external-link">officer::body_add()</a></code> instead of
<code><a href="https://davidgohel.github.io/officer/reference/body_add_par.html" class="external-link">officer::body_add_par()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_to_body</span><span class="op">(</span></span>
<span>  <span class="va">docx</span>,</span>
<span>  keyword <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  str <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pos <span class="op">=</span> <span class="st">"after"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_text_to_body</span><span class="op">(</span></span>
<span>  <span class="va">docx</span>,</span>
<span>  <span class="va">value</span>,</span>
<span>  style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pos <span class="op">=</span> <span class="st">"after"</span>,</span>
<span>  .na <span class="op">=</span> <span class="st">"NA"</span>,</span>
<span>  .null <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_xml_to_body</span><span class="op">(</span><span class="va">docx</span>, <span class="va">str</span>, pos <span class="op">=</span> <span class="st">"after"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_gt_to_body</span><span class="op">(</span><span class="va">docx</span>, <span class="va">gt_object</span>, pos <span class="op">=</span> <span class="st">"after"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_value_with_keys</span><span class="op">(</span><span class="va">docx</span>, <span class="va">value</span>, <span class="va">...</span>, .f <span class="op">=</span> <span class="va">add_text_to_body</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_str_with_keys</span><span class="op">(</span><span class="va">docx</span>, <span class="va">str</span>, <span class="va">...</span>, .f <span class="op">=</span> <span class="va">add_xml_to_body</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>docx</dt>
<dd><p>A rdocx object.</p></dd>


<dt>keyword, id</dt>
<dd><p>A keyword string used to place cursor with
<code><a href="https://davidgohel.github.io/officer/reference/cursor.html" class="external-link">officer::cursor_reach()</a></code> or bookmark id with <code><a href="https://davidgohel.github.io/officer/reference/cursor.html" class="external-link">officer::cursor_bookmark()</a></code>.
Defaults to <code>NULL</code>. If keyword or id are not provided, the gt object is
inserted at the front of the document.</p></dd>


<dt>index</dt>
<dd><p>A integer matching a doc_index value appearing in a summary of
the docx object created with <code><a href="https://davidgohel.github.io/officer/reference/docx_summary.html" class="external-link">officer::docx_summary()</a></code>. If index is for a
paragraph value, the text of the pargraph is used as a keyword.</p></dd>


<dt>value</dt>
<dd><p>object to add in the document. Supported objects
are vectors, data.frame, graphics, block of formatted paragraphs,
unordered list of formatted paragraphs,
pretty tables with package flextable, 'Microsoft' charts with package mschart.</p></dd>


<dt>str</dt>
<dd><p>a wml string</p></dd>


<dt>pos</dt>
<dd><p>where to add the new element relative to the cursor,
one of "after", "before", "on".</p></dd>


<dt>...</dt>
<dd><p>Additional parameters passed to <code><a href="https://davidgohel.github.io/officer/reference/body_add.html" class="external-link">officer::body_add()</a></code> or
<code><a href="https://davidgohel.github.io/officer/reference/body_add_xml.html" class="external-link">officer::body_add_xml()</a></code>.</p></dd>


<dt>style</dt>
<dd><p>paragraph style name. These names are available with function <a href="https://davidgohel.github.io/officer/reference/styles_info.html" class="external-link">styles_info</a>
and are the names of the Word styles defined in the base document (see
argument <code>path</code> from <a href="https://davidgohel.github.io/officer/reference/read_docx.html" class="external-link">read_docx</a>).</p></dd>


<dt>.na</dt>
<dd><p>[<code>character(1)</code>: ‘NA’]<br> Value to replace <code>NA</code> values
with. If <code>NULL</code> missing values are propagated, that is an <code>NA</code> result will
cause <code>NA</code> output. Otherwise the value is replaced by the value of <code>.na</code>.</p></dd>


<dt>.null</dt>
<dd><p>[<code>character(1)</code>: ‘character()’]<br> Value to replace
NULL values with. If <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> whole output is <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>. If
<code>NULL</code> all NULL values are dropped (as in <code><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0()</a></code>). Otherwise the
value is replaced by the value of <code>.null</code>.</p></dd>


<dt>.envir</dt>
<dd><p>[<code>environment</code>: <code><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame()</a></code>]<br> Environment to evaluate each expression in. Expressions are
evaluated from left to right. If <code>.x</code> is an environment, the expressions are
evaluated in that environment and <code>.envir</code> is ignored. If <code>NULL</code> is passed, it is equivalent to <code><a href="https://rdrr.io/r/base/environment.html" class="external-link">emptyenv()</a></code>.</p></dd>


<dt>gt_object</dt>
<dd><p>A gt object converted to an OOXML string with
<code><a href="https://gt.rstudio.com/reference/as_word.html" class="external-link">gt::as_word()</a></code> then passed to <code>add_xml_to_body()</code> as str parameter.
Required for <code>add_gt_to_body()</code>.</p></dd>


<dt>.f</dt>
<dd><p>Any function that takes a docx and value parameter and returns a
rdocx object. A keyword parameter must also be supported if named is TRUE.
Defaults to <code>add_text_to_body()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A rdocx object with added xml, gt tables, or paragraphs of text.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Using <code>add_value_with_keys()</code> or <code>add_str_with_keys()</code></p>
<p><code>add_value_with_keys()</code> supports value vectors of length 1 or longer. If
value is named, the names are assumed to be keywords indicating the cursor
position for adding each value in the vector. If value is not named, a
keyword parameter with the same length as value must be provided. When <code>named = FALSE</code>, no keyword parameter is required. Add <code>add_str_with_keys()</code> works
identically but uses a str parameter and .f defaults to <code>add_xml_to_body()</code>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Eli Pousson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

